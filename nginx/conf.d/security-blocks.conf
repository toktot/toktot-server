# 민감한 파일 접근 차단
location ~ /\. {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 환경설정 파일 차단
location ~ \.(env|ini|conf|cnf|cfg|config)$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# Git 관련 파일 차단
location ~ /\.git {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# Apache 설정 파일 차단
location ~ /\.ht {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 백업 파일 차단
location ~ \.(bak|backup|old|orig|save|tmp|temp|swp|swo)$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 로그 파일 차단
location ~ \.(log|logs)$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# SQL 덤프 파일 차단
location ~ \.(sql|dump)$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 압축 파일 차단
location ~ \.(tar|tgz|gz|zip|rar|7z)$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# PHP 관련 파일 차단
location ~ \.php$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# WordPress 관련 경로 차단
location ~ ^/(wp-admin|wp-includes|wp-content|wp-login|wp-config) {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 관리자 페이지 접근 시도 차단
location ~ ^/(admin|administrator|manager|phpmyadmin|pma|mysql|adminer) {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 일반적인 공격 경로 차단
location ~ ^/(xmlrpc\.php|readme\.html|license\.txt) {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 웹 셸 및 악성 스크립트 차단
location ~ \.(asp|aspx|jsp|cgi|pl|py|rb|sh)$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 의존성 관리 파일 차단
location ~ ^/(composer\.(json|lock)|package\.(json|lock)|yarn\.lock|Gemfile|requirements\.txt)$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# IDE 설정 파일 차단
location ~ ^/\.(vscode|idea|eclipse|netbeans) {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# Docker 관련 파일 차단
location ~ ^/(Dockerfile|docker-compose\.(yml|yaml)|\.dockerignore)$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}

# 보안 정보가 포함될 수 있는 텍스트 파일 차단
location ~ ^/(TODO|CHANGELOG|HISTORY|README|INSTALL|UPGRADE|COPYING|LICENSE)(\.(txt|md|rst))?$ {
    deny all;
    access_log off;
    log_not_found off;
    return 404;
}