# IP 차단
location / {
    deny 185.177.72.54;
    try_files $uri @proxy_to_app;
}

# 프록시 처리를 위한 내부 location
location @proxy_to_app {
    proxy_pass http://app:8080;
    include /etc/nginx/conf.d/proxy_params.conf;
}

# 보안 모니터링을 위한 차단된 IP 로깅
location @blocked_ip {
    access_log /var/log/nginx/blocked_ips.log json_combined;
    return 403 '{"error": "Forbidden", "message": "Access denied from your IP address", "code": "IP_BLOCKED"}';
}